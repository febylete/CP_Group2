---
title: "Sejin Data Check"
author: "Group 2"
date: "2024-03-01"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Packages
```{r packageload}
library(readr)
library(dplyr)
library(car)
library(ggplot2)
library(gridExtra)
```

#Data loading
```{r dataload}
CNdata_filtered_120123 <- read_csv("CNdata_filtered_120123.csv")
ENdata_filtered_110123 <- read_csv("ENdata_filtered_110123.csv")
```

#Data prep
```{r dataprep, echo=FALSE}
###need to use cred and nw totals... 

#Chinese data, renaming/changing data types to factors
CNdata_filtered_120123$Feed <- CNdata_filtered_120123$feed_typefour
CNdata_filtered_120123$Feed <- as.factor(CNdata_filtered_120123$Feed)
CNdata_filtered_120123$valence <- as.factor(CNdata_filtered_120123$valence)

#Chinese data, selecting relevant variables
Data_CN <- CNdata_filtered_120123 |> 
  dplyr::select(Feed,valence,credavg_all,nwavg_all,share_all,NewsSharing_SM,NewsCred_SM,AI_acceptance,gender,age) |> 
  mutate(Group = 1)

#English data, adding/renaming relevant variables
ENdata_filtered_110123$NewsCred_SM <- unlist(ENdata_filtered_110123[,255])#rename to match CN data

#English data, selecting relevant variables
Data_EN <-ENdata_filtered_110123 |> 
  dplyr::mutate(valence = feed_valence) |>
  dplyr::mutate(Feed = feedtype_four) |> 
  dplyr::select(Feed,valence,credavg_all,nwavg_all,share_all,NewsSharing_SM,NewsCred_SM,AI_acceptance,gender,age) |> 
  mutate(Group = 0)

#English data, changing data types to factors
Data_EN$Feed <- as.factor(Data_EN$Feed)
Data_EN$valence <- as.factor(Data_EN$valence)

#one dataframe, Group (1 = Chinese 0 = American)
Data <- rbind(Data_CN,Data_EN)
Data$Group <- as.factor(Data$Group)

#fixing age and gender
Data$age <- 2024 - Data$age
Data$gender <- as.factor(Data$gender)

#can select additional variables for regression, these were just the ones that stuck out as easy to add

##AI acceptance only for EN data??
```

#some plots
```{r plots}

#Feed X Shareworthiness (ordinal, so boxplot)
boxS1 <- ggplot(Data_EN, aes(Feed,share_all,fill=Feed)) +
  geom_boxplot() + 
  ggtitle("English Data Feed Type and Shareworthiness Scores (Ordinal)")

boxS2 <- ggplot(Data_CN, aes(Feed,share_all,fill=Feed)) +
  geom_boxplot() + 
  ggtitle("Chinese Data Feed Type and Shareworthiness Scores (Ordinal)")

boxS3 <- ggplot(Data, aes(Feed, share_all,fill=Feed)) +
  geom_boxplot() +
  ggtitle("All Data Feed Type and Shareworthiness Scores (Ordinal)")

grid.arrange(boxS1,boxS2,boxS3,nrow=1)

#------------------------------------------------------------------------------

#Feed X Crediworthiness
ViolinC1 <- ggplot(Data_EN, aes(Feed,credavg_all,fill=Feed)) +
  geom_violin() +
  ggtitle("English Data Feed Type and Creditworthiness Scores")

ViolinC2 <- ggplot(Data_CN, aes(Feed,credavg_all,fill=Feed)) +
  geom_violin() +
  ggtitle("Chinese Data Feed Type and Creditworthiness Scores")

ViolinC3 <- ggplot(Data, aes(Feed,credavg_all,fill=Feed)) +
  geom_violin() +
  ggtitle("All Data Feed Type and Creditworthiness Scores")

grid.arrange(ViolinC1,ViolinC2,ViolinC3, nrow=1)

#------------------------------------------------------------------------------

#Feed X Shareworthiness
ViolinS1 <- ggplot(Data_EN, aes(Feed,share_all,fill=Feed)) +
  geom_violin() +
  ggtitle("English Data Feed Type and Shareworthiness Scores")

ViolinS2 <- ggplot(Data_CN, aes(Feed,share_all,fill=Feed)) + 
  geom_violin() +
  ggtitle("English Data Feed Type and Shareworthiness Scores")

ViolinS3 <- ggplot(Data, aes(Feed, share_all,fill=Feed)) +
  geom_violin() +
  ggtitle("English Data Feed Type and Shareworthiness Scores")

grid.arrange(ViolinS1,ViolinS2,ViolinS3, nrow=1)

```

# Hypothesis 1
Memes will produce a greater level of:
 a) Credibility
 b) Newsworthiness
 c) Share-worthiness
Compared to the news-only feed.

## Hypothesis 1 testing

To test this hypothesis, 3 separate t-tests will be used to compare -- between the participants in the meme and news-only feeds -- the scores of each of these three measurements.

### H1 Assumption checking

```{r}

# A) visuals for English Data normality checking

# Credibility
res_cred_EN <- aov(credavg_all~Feed,Data_EN)
par(mfrow=c(1,2))
hist(res_cred_EN$residuals)
qqPlot(res_cred_EN$residuals,id=FALSE)

# Newsworthiness
res_NW_EN <- aov(nwavg_all~Feed,Data_EN)
par(mfrow=c(1,2))
hist(res_NW_EN$residuals)
qqPlot(res_NW_EN$residuals,id=FALSE)

# Shareworthiness
res_SW_EN <- aov(credavg_all~Feed,Data_EN)
par(mfrow=c(1,2))
hist(res_cred_EN$residuals)
qqPlot(res_cred_EN$residuals,id=FALSE)


# A) visuals for Chinese Data normality checking

# Credibility
res_cred_CN <- aov(credavg_all~Feed,Data_CN)
par(mfrow=c(1,2))
hist(res_cred_CN$residuals)
qqPlot(res_cred_CN$residuals,id=FALSE)

# Newsworthiness
res_NW_CN <- aov(nwavg_all~Feed,Data_CN)
par(mfrow=c(1,2))
hist(res_NW_CN$residuals)
qqPlot(res_NW_CN$residuals,id=FALSE)

# Shareworthiness
res_SW_EN <- aov(credavg_all~Feed,Data_CN)
par(mfrow=c(1,2))
hist(res_cred_CN$residuals)
qqPlot(res_cred_CN$residuals,id=FALSE)


# A) visuals for Combined Data normality checking

# Credibility
res_cred_Data <- aov(credavg_all~Feed,Data)
par(mfrow=c(1,2))
hist(res_cred_Data$residuals)
qqPlot(res_cred_Data$residuals,id=FALSE)

# Newsworthiness
res_NW_Data <- aov(nwavg_all~Feed,Data)
par(mfrow=c(1,2))
hist(res_NW_EN$residuals)
qqPlot(res_NW_EN$residuals,id=FALSE)

# Shareworthiness
res_SW_Data <- aov(credavg_all~Feed,Data)
par(mfrow=c(1,2))
hist(res_cred_Data$residuals)
qqPlot(res_cred_Data$residuals,id=FALSE)


```


### H1 T-tests + Regression
```{r}
### T-tests
# 1 = Memes 2 = News-only
Hyp1TestData <- Data |> 
  filter(Feed == 1 | Feed == 2)

C_T_Test <- t.test(credavg_all ~ Feed , data = Hyp1TestData)

NW_T_Test <- t.test(nwavg_all ~ Feed, data = Hyp1TestData)

SW_T_Test <- t.test(share_all ~ Feed, data = Hyp1TestData)

C_T_Test

NW_T_Test

SW_T_Test

### Regression

#Regression for Credibility
LR_Credibility_All <- lm(credavg_all ~ Feed + valence + Group,Data)

summary(LR_Credibility_All)

#Regression for Share-worthiness
LR_Shareworthiness_All <- lm(share_all ~ Feed + valence + Group,Data)

summary(LR_Shareworthiness_All)

#Regression for Newsworthiness

LR_Newsworthiness_All <- lm(nwavg_all ~ Feed + valence + Group,Data)

summary(LR_Newsworthiness_All)

broom::tidy(LR_Credibility_All)

broom::tidy(LR_Newsworthiness_All)

broom::tidy(LR_Shareworthiness_All)

```


# Hypothesis 2
Activism will produce a greater level of:
  a) Newsworthiness
  b) Share-worthiness
Compared with the other 3 feeds

## Hypothesis 2 testing
```{r}
#Anova first, followed by separate t-tests w Bonferroni (necessary)?



```

### H2 Assumption checking

### One-way Anovas
```{r OneWays}
# Chinese Cred Anova
ANOVA_Cred_CN <- aov(credavg_all ~ Feed,data=Data_CN)
summary(ANOVA_Cred_CN)

# English Cred Anova
ANOVA_Cred_EN <- aov(credavg_all ~ Feed,data=Data_EN)
summary(ANOVA_Cred_EN)

#---------------------------------------------------------
# Chinese Newsworthiness Anova
ANOVA_NW_CN <- aov(nwavg_all ~ Feed,data=Data_CN)
summary(ANOVA_NW_CN)

# English Newsworthiness Anova
ANOVA_NW_EN <- aov(nwavg_all ~ Feed,data=Data_EN)
summary(ANOVA_NW_EN)

#---------------------------------------------------------
# Chinese Share Anova
ANOVA_Share_CN <- aov(share_all ~ Feed,data=Data_CN)
summary(ANOVA_Share_CN)

# English Share Anova
ANOVA_Share_EN <- aov(share_all ~ Feed,data=Data_EN)
summary(ANOVA_Share_EN)
```


##ANCOVA

###Assumption checks

```{r independence}

```

```{r homogeneity of variance}
###Use Levene's
library(car)

##newsworthiness... p > .05 for all three partitions of the data, so no concerns about heterogeneity of variance for newsworthiness across the 4 different feed types
leveneTest(nwavg_all~Feed,data=Data_EN)
leveneTest(nwavg_all~Feed,data=Data_CN)
leveneTest(nwavg_all~Feed,data=Data)

###shareworthiness...

```


# before combining the two, need to make sure the test can handle unequal sample sizes between the english and the chinese... if not, use Kruskal-Wallis


# RQ 1
How does the activism feed affect perceptions of news credibility compared to the other surrounding content feeds?

# RQ 2
How does the advertisement feed affect perceptions of:
  a) Credibility
  b) Newsworthiness
  c) Share-worthiness
compared to the other surrounding content feeds?

# RQ 3
How does news valence moderate the impact of external content elements on:
  a) Credibility
  b) Newsworthiness
  c) Share-worthiness
?

# RQ 4
How do the following vary between the English and Chinese samples?:
  a) Credibility
  b) Newsworthiness
  c) Share-worthiness
  

## Two-way Anovas?
```{r}

```
