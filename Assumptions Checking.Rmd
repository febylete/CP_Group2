---
title: "Consulting Project"
author: "Febriany Lete"
date: "2024-02-26"
output:
  word_document: default
  html_document: default
  pdf_document: default
---

```{r, echo=FALSE}
library(car)
library(ggplot2)
```

```{r, echo=FALSE}
ENData <- read.csv("ENdata_filtered_110123.csv")
CNData <- read.csv("CNdata_filtered_120123.csv")
```

# **English Data Set**

**Visualization For Normality Check**

1. Feed Type
```{r, echo=FALSE}
res_cred <- aov(credavg_all ~ feedtype_four, data = ENData)
par(mfrow = c(1, 2))
hist(res_cred$residuals)
qqPlot(res_cred$residuals, id = FALSE)

res_news <- aov(nwavg_all ~ feedtype_four, data = ENData)
par(mfrow = c(1, 2))
hist(res_news$residuals)
qqPlot(res_news$residuals, id = FALSE)

res_share <- aov(share_all ~ feedtype_four, data = ENData)
par(mfrow = c(1, 2))
hist(res_share$residuals)
qqPlot(res_share$residuals, id = FALSE)
```

2.  Feed Valence
```{r, echo=FALSE}
res_credv <- aov(credavg_all ~ feed_valence, data = ENData)
par(mfrow = c(1, 2))
hist(res_credv$residuals)
qqPlot(res_credv$residuals, id = FALSE)

res_newsv <- aov(nwavg_all ~ feed_valence, data = ENData)
par(mfrow = c(1, 2))
hist(res_newsv$residuals)
qqPlot(res_newsv$residuals, id = FALSE)

res_sharev <- aov(share_all ~ feed_valence, data = ENData)
par(mfrow = c(1, 2))
hist(res_sharev$residuals)
qqPlot(res_sharev$residuals, id = FALSE)
```

**Visualization For Homogeneity Check**

```{r, echo=FALSE}
boxplot(credavg_all ~ feedtype_four, data = ENData)
boxplot(nwavg_all ~ feedtype_four, data = ENData)
boxplot(share_all ~ feedtype_four, data = ENData)
boxplot(credavg_all ~ feed_valence, data = ENData)
boxplot(nwavg_all ~ feed_valence, data = ENData)
boxplot(share_all ~ feed_valence, data = ENData)
```


**Normality Test: Shapiro-Wilk**

```{r, echo=FALSE}
shapiro.test(res_cred$residuals)
shapiro.test(res_news$residuals)
shapiro.test(res_share$residuals)
shapiro.test(res_credv$residuals)
shapiro.test(res_newsv$residuals)
shapiro.test(res_sharev$residuals)
```


**Normality Test: Kolmogorov - Smirnov**

```{r, echo=FALSE}
#Variabel Dependent
variables <- c("credavg_all", "nwavg_all", "share_all")
for (i in variables) {
  result <- ks.test(ENData[[i]], "pnorm")
  print(result)
}
```

```{r, echo=FALSE}
#Variable Independent
variables <- c("feedtype_four", "feed_valence")
for (i in variables) {
  result <- ks.test(ENData[[i]], "pnorm")
  print(result)
}
```

**Homogeneity Test: Levene's Test**

```{r, echo=FALSE}
ENData$feed_type1 <- factor(ENData$feed_type)
ENData$feed_valence1 <- factor(ENData$feed_valence)

result1 <- leveneTest(credavg_all ~ feed_type1, data = ENData)
print(result1)
result2 <- leveneTest(nwavg_all ~ feed_type1, data = ENData)
print(result2)
result3 <- leveneTest(share_all ~ feed_type1, data = ENData)
print(result3)
result4 <- leveneTest(credavg_all ~ feed_valence1, data = ENData)
print(result4)
result5 <- leveneTest(nwavg_all ~ feed_valence1, data = ENData)
print(result5)
result6 <- leveneTest(share_all ~ feed_valence1, data = ENData)
print(result6)
```

# **Chinese Data Set**

**Visualization For Normality Check**

1. Feed Type
```{r, echo=FALSE}
res_cred1 <- aov(credavg_all ~ feed_typefour, data = CNData)
par(mfrow = c(1, 2))
hist(res_cred1$residuals)
qqPlot(res_cred1$residuals, id = FALSE)

res_news1 <- aov(nwavg_all ~ feed_typefour, data = CNData)
par(mfrow = c(1, 2))
hist(res_news1$residuals)
qqPlot(res_news1$residuals, id = FALSE)

res_share1 <- aov(share_all ~ feed_typefour, data = CNData)
par(mfrow = c(1, 2))
hist(res_share1$residuals)
qqPlot(res_share1$residuals, id = FALSE)
```

2. Feed Valence
```{r, echo=FALSE}
res_credv1 <- aov(credavg_all ~ valence, data = CNData)
par(mfrow = c(1, 2))
hist(res_credv1$residuals)
qqPlot(res_credv1$residuals, id = FALSE)

res_newsv1 <- aov(nwavg_all ~ valence, data = CNData)
par(mfrow = c(1, 2))
hist(res_newsv1$residuals)
qqPlot(res_newsv1$residuals, id = FALSE)

res_sharev1 <- aov(share_all ~ valence, data = CNData)
par(mfrow = c(1, 2))
hist(res_sharev1$residuals)
qqPlot(res_sharev1$residuals, id = FALSE)
```
**Visualization For Homogeneity Check**

```{r, echo=FALSE}
boxplot(credavg_all ~ feed_typefour, data = CNData)
boxplot(nwavg_all ~ feed_typefour, data = CNData)
boxplot(share_all ~ feed_typefour, data = CNData)
boxplot(credavg_all ~ valence, data = CNData)
boxplot(nwavg_all ~ valence, data = CNData)
boxplot(share_all ~ valence, data = CNData)
```
**Normality Test: Shapiro-Wilk**

```{r, echo=FALSE}
shapiro.test(res_cred1$residuals)
shapiro.test(res_news1$residuals)
shapiro.test(res_share1$residuals)
shapiro.test(res_credv1$residuals)
shapiro.test(res_newsv1$residuals)
shapiro.test(res_sharev1$residuals)
```

**Normality Test: Kolmogorov - Smirnov**

```{r, echo=FALSE}
#Variabel Dependent
variables <- c("credavg_all", "nwavg_all", "share_all")
for (i in variables) {
  result <- ks.test(CNData[[i]], "pnorm")
  print(result)
}
```

```{r, echo=FALSE}
#Variable Independent
variables <- c("feed_typefour", "valence")
for (i in variables) {
  result <- ks.test(CNData[[i]], "pnorm")
  print(result)
}
```
**Homogeneity Test: Levene's Test**

```{r, echo=FALSE}
CNData$feed_type1 <- factor(CNData$feed_type)
CNData$feed_valence1 <- factor(CNData$valence)

result7 <- leveneTest(credavg_all ~ feed_type1, data = CNData)
print(result7)
result8 <- leveneTest(nwavg_all ~ feed_type1, data = CNData)
print(result8)
result9 <- leveneTest(share_all ~ feed_type1, data = CNData)
print(result9)
result10 <- leveneTest(credavg_all ~ feed_valence1, data = CNData)
print(result10)
result11 <- leveneTest(nwavg_all ~ feed_valence1, data = CNData)
print(result11)
result12 <- leveneTest(share_all ~ feed_valence1, data = CNData)
print(result12)
```

