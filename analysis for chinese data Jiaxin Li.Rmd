---
title: "Analysis for Chinese Data"
author: "Jiaxin Li"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```



```{r}
chinese_data_filtered <- read.csv("CNdata_filtered_120123.csv")
View(chinese_data_filtered)
```


```{r}
unique(chinese_data_filtered$valence)
unique(chinese_data_filtered$feed_type)
```



```{r}
glimpse(chinese_data_filtered)
```





```{r}
chinese_data_filtered$feed_type <- factor(chinese_data_filtered$feed_type)

chinese_data_filtered$Credibility_Total <- chinese_data_filtered$Credibility_1+chinese_data_filtered$Credibility_2+chinese_data_filtered$Credibility_3+chinese_data_filtered$Credibility_4

chinese_data_filtered$newsworth_all <- chinese_data_filtered$NW_1+chinese_data_filtered$NW_2+chinese_data_filtered$NW_3+chinese_data_filtered$NW_4

  

```


```{r}
chinese_data_filtered$feed_type <- ifelse(chinese_data_filtered$valence == 2,
                                          paste0("neg_", chinese_data_filtered$feed_type),
                                          paste0("pos_", chinese_data_filtered$feed_type))

chinese_data_filtered$feed_type <- factor(chinese_data_filtered$feed_type)

unique(chinese_data_filtered$feed_type)
```





```{r}
colnames(chinese_data_filtered)
```








# covariates：

"NewsSharing_SM", "NewsCred_SM" 

((1) frequency of news sharing on social media and 2) news credibility perception on social media     与 (1) how often did you share a news post that you saw on your social media? and 2) How credible do you think the news posts you saw on social media are?)

# Y 

dependent variable: 
a) credibility  :"credavg_all"
b) newsworthiness  :"nwavg_all"
c) shareworthiness  :"share_all"




# fixed factors

"feed_type"
surrounding content elements and news valence were included as fixed factors






# EDA


```{r}
boxplot(credavg_all ~ feed_type,
data = chinese_data_filtered,
main = "credibility by feedtype and news valence (ENdata)",
xlab = "feedtype",ylab = "Credibility",
col = "pink",border = "black")


boxplot(nwavg_all ~ feed_type,
data = chinese_data_filtered,
main = "newsworthiness by feedtype and news valence (ENdata)",
xlab = "feedtype",ylab = "newsworthiness",
col = "pink",border = "black")


boxplot(share_all ~ feed_type,
data = chinese_data_filtered,
main = "shareworthiness by feedtype and news valence (ENdata)",
xlab = "feedtype",ylab = "shareworthiness",
col = "pink",border = "black")

```






# Model Assumptions
When we do ANCOVA, we need to check some basic assumptions.

1. The covariate and the treatment are independent

Need to verify that the covariate in this case grade and the technique are independent to each other.

2.Homogeneity of variance

Verify the variances among the groups is equal or not




## 1. For assumption 1 we can make use of the ANOVA model.


```{r}
model1 <- aov(NewsSharing_SM ~ feed_type, data = chinese_data_filtered)
summary(model1)
```

The p-value is 0.369 that is greater than 0.05, so the covariate "NewsSharing_SM" and the "feedtype" are independent to each other.




```{r}
model2 <- aov(NewsCred_SM ~ feed_type, data = chinese_data_filtered)
summary(model2)
```

The p-value is 0.32 that is greater than 0.05, so the covariate "NewsCred_SM" and the "feedtype" are independent to each other.








## 2.Homogeneity of variance (Levene's Test)


### 2.1 Credibility_Total

```{r}
library(car)
leveneTest(credavg_all ~ feed_type, data = chinese_data_filtered)
```

The p-value of the test is 0.6334 (>0.05), which indicates that the variances among the groups can be regarded as equal.



### 2.2 newsworth_all

```{r}
library(car)
leveneTest(nwavg_all ~ feed_type, data = chinese_data_filtered)

```

The p-value of the test is 0.404 (>0.05), which indicates that the variances among the groups can be regarded as equal.




### 2.3 share_all

```{r}
library(car)
leveneTest(share_all ~ feed_type, data = chinese_data_filtered)
```


The p-value of the test is 0.3387 (>0.05), which indicates that the variances among the groups can be regarded as equal. 







# Fit analysis of covariance model ANCOVA in R


1. credibility

```{r}
library(car)
ancova_model_credibility <- aov(credavg_all ~ feed_type + NewsSharing_SM + NewsCred_SM, data = chinese_data_filtered)
Anova(ancova_model_credibility, type="III")
```




2. newsworthiness

```{r}
library(car)
ancova_model_newsworthiness <- aov(nwavg_all ~ feed_type + NewsSharing_SM + NewsCred_SM, data = chinese_data_filtered)
Anova(ancova_model_newsworthiness, type="III")
```




3. shareworthiness

```{r}
library(car)
ancova_model_shareworthiness <- aov(share_all ~ feed_type + NewsSharing_SM + NewsCred_SM, data = chinese_data_filtered)
Anova(ancova_model_shareworthiness, type="III")
```








# Then we want to know which feed types are different from each other. Make usage multi-comp package for pairwise comparison.

```{r}
# install.packages("multcomp")
library(multcomp)
postHocs <- glht(ancova_model_credibility, linfct = mcp(feed_type = "Tukey"))
summary(postHocs)
```


In the evaluation of Credibility_Total, the 'nmemes' feed_type demonstrates significant superiority over both 'act' and 'news' levels. Additionally, the 'news' level exhibits significant superiority over the 'nmemes' level. No significant differences were observed among the other levels.

The following feed_type pairs exhibit significant differences at a significance level of 0.05:
nmemes - act
nmemes - news






```{r}
library(multcomp)
postHocs <- glht(ancova_model_newsworthiness, linfct = mcp(feed_type = "Tukey"))
summary(postHocs)
```



significant differences exist among certain feed types in your dataset, while others demonstrate no significant disparities. These differences may relate to newsworthiness, though specific impacts may require further analysis and interpretation.

Here are the feed_type comparisons that exhibit significant differences based on your results:
(1) nact - ad: Highly significant difference (p < 0.001).
(2) nad - ad: Significant difference (p = 0.0175).
(3) nact - memes: Significant difference (p = 0.0222).
(4) nmemes - nact: Significant difference (p = 0.0196).






```{r}
library(multcomp)
postHocs <- glht(ancova_model_shareworthiness, linfct = mcp(feed_type = "Tukey"))
summary(postHocs)
```






























